class MapboxField{constructor($container){this.$container=$container,this.rendered=!1}static _getAccessToken(){return window.mapboxAccessToken}_getLngLatValue(){return[this._getLngField().val(),this._getLatField().val()]}_setLngLatValue(coords){this._getLngField().val(coords[0]).change(),this._getLatField().val(coords[1]).change()}_getLngField(){return this.$container.find('input[data-mapbox-field="Longitude"]')}_getLatField(){return this.$container.find('input[data-mapbox-field="Latitude"]')}render(){if(this.rendered)return;mapboxgl.accessToken=MapboxField._getAccessToken();const container=this.$container.find(".mapbox__map").get(0),style=container.dataset.mapboxStyle,map=new mapboxgl.Map({container,style,center:this._getLngLatValue(),zoom:15}),marker=new mapboxgl.Marker({draggable:!0}).setLngLat(this._getLngLatValue()).addTo(map);marker.on("dragend",()=>{this._onMarkerUpdate(marker)});const geocoder=new MapboxGeocoder({accessToken:MapboxField._getAccessToken(),mapboxgl});map.addControl(geocoder),geocoder.on("result",event=>{marker.setLngLat(event.result.geometry.coordinates),this._onMarkerUpdate(marker)}),map.addControl(new mapboxgl.NavigationControl),this.rendered=!0}_onMarkerUpdate(marker){const lngLat=marker.getLngLat();this._setLngLatValue([lngLat.lng,lngLat.lat])}}jQuery.entwine("ss",$=>{$(".cms-edit-form .mapbox").entwine({MapboxField:null,onmatch(){this.getMapboxField()||this.setMapboxField(new MapboxField(this))}}),$('.cms-edit-form [aria-hidden="false"] .mapbox').entwine({onmatch(){this._super(),this.getMapboxField().render()}}),$(".cms-edit-form .mapbox:not(.tabset .mapbox)").entwine({onmatch(){this._super(),this.getMapboxField().render()}})});
